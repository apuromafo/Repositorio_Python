# -*- coding: utf-8 -*-
# Script de gu√≠a r√°pida conceptual sobre c√≥mo utilizar la salida de esc√°neres
# (Nessus, Burp, OpenVAS, ZAP) como fuente de datos para la generaci√≥n de informes.

# C√≥digos ANSI para colores (sin dependencias adicionales)
BLUE = "\033[94m"    # Azul
GREEN = "\033[92m"   # Verde
RED = "\033[91m"     # Rojo
YELLOW = "\033[93m"  # Amarillo
END = "\033[0m"      # Restablecer color
BOLD = "\033[1m"     # Negrita

# --- T√çTULO Y DESCRIPCI√ìN ---
print(f"{BOLD}{BLUE}\n*************************************************************{END}")
print(f"{BOLD}{BLUE}üìù GU√çA DE EXPORTACI√ìN DE DATOS PARA INFORMES DE PENTESTING üìù{END}")
print(f"{BOLD}{BLUE}*************************************************************{END}")
print(f"{YELLOW}Fase 1: Generaci√≥n de archivos de datos brutos desde las herramientas.{END}")

# --- INTRODUCCI√ìN SOBRE LA IMPORTANCIA DE LA EXPORTACI√ìN DE ESC√ÅNERES ---
print(f"{BOLD}{YELLOW}\n[INTRODUCCI√ìN VITAL]{END}")
print(f"{YELLOW}El rol de las herramientas de escaneo como {BOLD}Nessus, Burp Suite Professional, OpenVAS y OWASP ZAP{END} es crucial.")
print(f"{YELLOW}Aunque su objetivo primario es identificar vulnerabilidades, su funci√≥n de {BOLD}exportar el resultado t√©cnico completo{END} en formatos estructurados (como XML o CSV) es vital.")
print(f"{YELLOW}Estos archivos act√∫an como el {BOLD}{RED}esqueleto de la secci√≥n de hallazgos del informe final{END}, proveyendo la base de datos t√©cnica para la posterior redacci√≥n y el resumen ejecutivo.")

# ----------------------------------------------------------------------------------
# --- FASE 1: GENERACI√ìN DE DATOS DE REPORTE (EXPORTACI√ìN DESDE ESC√ÅNERES) ---
# ----------------------------------------------------------------------------------
print(f"{BOLD}{BLUE}\n--- FASE 1: EXTRACCI√ìN DE HALLAZGOS T√âCNICOS ---{END}")

# --- PASO 1: NESSUS/OPENVAS (Esc√°neres de Red/Sistema) ---
print(f"{BOLD}{GREEN}\n--- PASO 1: Exportar de Nessus / OpenVAS ---{END}")
print(f"{BOLD}Acci√≥n:{END} Obtener un listado estructurado de todas las vulnerabilidades encontradas.")
print(f"{YELLOW}En la interfaz gr√°fica de cada herramienta:{END}")
print(f"  {BOLD}Nessus:{END} Selecciona la pol√≠tica de escaneo y exporta a formato {RED}Tenable Nessus XML (.nessus){END} o {RED}CSV{END}.")
print(f"  {BOLD}OpenVAS:{END} Genera el reporte y selecciona la salida en formato {RED}XML{END} o {RED}CSV{END}.")
print(f"{BOLD}Resultado:{END} Archivo(s) con ID, descripci√≥n, severidad (CVSS), recomendaci√≥n y evidencia t√©cnica de cada hallazgo.")

# --- PASO 2: BURP SUITE PROFESSIONAL (Esc√°ner Web) ---
print(f"{BOLD}{GREEN}\n--- PASO 2: Exportar de Burp Suite Pro ---{END}")
print(f"{BOLD}Acci√≥n:{END} Documentar los problemas espec√≠ficos de la aplicaci√≥n web auditada (ej. Vulnerabilidades de servidor o configuraci√≥n).")
print(f"{YELLOW}Dentro de la Consola de Burp (Dashboard o Target Site Map):{END}")
print(f"  {BOLD}Comando/Opci√≥n:{END} Utiliza la opci√≥n para generar un informe ({RED}Generate HTML report{END} o {RED}Generate XML Report{END}).")
print(f"{BOLD}Resultado:{END} Archivo(s) {RED}XML/HTML{END} detallando vulnerabilidades web (XSS, SQLi, etc.) con sus par√°metros afectados y evidencia.")

# --- PASO 3: OWASP ZAP (Zed Attack Proxy) ---
print(f"{BOLD}{GREEN}\n--- PASO 3: Exportar de OWASP ZAP ---{END}")
print(f"{BOLD}Acci√≥n:{END} Generar un informe de vulnerabilidades web para aplicaciones que han sido auditadas con ZAP.")
print(f"{YELLOW}En la interfaz gr√°fica de ZAP (o v√≠a API):{END}")
print(f"  {BOLD}Opci√≥n:{END} Utiliza la funcionalidad 'Report' y selecciona formatos como {RED}HTML, XML, JSON o Markdown{END}.")
print(f"{BOLD}Resultado:{END} Documento que detalla los hallazgos de seguridad (activos y pasivos) en la aplicaci√≥n web, incluyendo la prueba de concepto.")

# --- PASO 4: METASPLOIT/NMAP/Manuales (Evidencia de Explotaci√≥n) ---
print(f"{BOLD}{GREEN}\n--- PASO 4: Documentar Evidencia (Manual/Exploitation) ---{END}")
print(f"{BOLD}Acci√≥n:{END} Registrar la evidencia de compromiso que no se extrae autom√°ticamente.")
print(f"{YELLOW}Proceso:{END} Guardar y etiquetar capturas de pantalla, logs de comandos y *hashes* de contrase√±as. Estos se incorporar√°n al informe final como anexos de evidencia.")
print(f"{BOLD}Resultado:{END} Archivos de evidencia ({RED}.png, .txt, .log{END}) listos para adjuntar.")

# ----------------------------------------------------------------------------------
# --- FASE 2: PROCESAMIENTO Y CONSOLIDACI√ìN DE HALLAZGOS ---
# ----------------------------------------------------------------------------------
print(f"{BOLD}{BLUE}\n--- FASE 2: IMPORTACI√ìN Y LIMPIEZA DE DATOS ---{END}")

# --- PASO 5: HERRAMIENTA DE CONSOLIDACI√ìN (Ej. Dradis o PWNDoc) ---
print(f"{BOLD}{GREEN}\n--- PASO 5: Importar a la Plataforma de Reporte ---{END}")
print(f"{BOLD}Acci√≥n:{END} Utilizar una herramienta de reporting para parsear los archivos t√©cnicos brutos.")
print(f"{YELLOW}Ejemplo de Comando Conceptual (si usas un script Python/Pandoc):{END}")
print(f"  {RED}python parse_nessus.py -input report.nessus -output findings.json{END}")
print(f"{YELLOW}Funci√≥n de la herramienta:{END} Lee el XML/CSV de los esc√°neres y extrae solo la informaci√≥n relevante (ID, Riesgo, Recomendaci√≥n).")

# --- PASO 6: NORMALIZACI√ìN Y ASIGNACI√ìN DE SEVERIDAD ---
print(f"{BOLD}{GREEN}\n--- PASO 6: Normalizaci√≥n de Hallazgos ---{END}")
print(f"{BOLD}Acci√≥n:{END} Unificar criterios y a√±adir contexto manual a cada hallazgo.")
print(f"{YELLOW}En la Interfaz de la Plataforma (Dradis/PWNDoc):{END}")
print(f"  {BOLD}Revisi√≥n:{END} Se eliminan falsos positivos y se ajusta la severidad de las vulnerabilidades ({RED}de media a alta, por ejemplo{END}) seg√∫n el contexto del cliente.")
print(f"{BOLD}Resultado:{END} Una base de datos limpia y verificada de todos los hallazgos (el coraz√≥n del informe).")

# ----------------------------------------------------------------------------------
# --- FASE 3: GENERACI√ìN FINAL DEL INFORME ---
# ----------------------------------------------------------------------------------
print(f"{BOLD}{BLUE}\n--- FASE 3: GENERACI√ìN Y FORMATO FINAL ---{END}")

# --- PASO 7: GENERACI√ìN CON PLANTILLA ---
print(f"{BOLD}{GREEN}\n--- PASO 7: Aplicar Plantilla de Informe ---{END}")
print(f"{BOLD}Acci√≥n:{END} Generar el informe utilizando la base de datos limpia y una plantilla de formato profesional.")
print(f"{YELLOW}Comando/Proceso:{END} La herramienta de reporting (o script) inserta los datos en los marcadores de posici√≥n de una plantilla ({RED}.docx, .pdf, .tex{END}).")
print(f"{BOLD}Resultado:{END} Un documento pre-formateado con todas las secciones de hallazgos, descripciones y recomendaciones t√©cnicas ya redactadas.")

# --- CIERRE ---
print(f"{BOLD}{BLUE}\n*************************************************************{END}")
print(f"{BOLD}{BLUE}‚úÖ PROCESO COMPLETADO{END}")
print(f"{YELLOW}La salida t√©cnica de los esc√°neres ha sido convertida en un borrador de informe listo para la edici√≥n final y el resumen ejecutivo.{END}")
print(f"{BOLD}{BLUE}*************************************************************{END}\n{END}")